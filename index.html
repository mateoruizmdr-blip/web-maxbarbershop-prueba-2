<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Max Studio Barber Shop</title>
    <meta name="description" content="Barbería moderna en Madrid. Estilo, precisión y actitud. Reserva tu cita online.">
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css?v=1.1">
</head>

<body>
<script>
  // CONFIGURACIÓN: Cambia estas URLs por tus URLs de PRODUCCIÓN de n8n
  const URL_RESERVAR = "https://unstormable-trothless-gilberto.ngrok-free.dev/webhook/eee10825-ff7e-4622-8ba9-37596ffd9745";
  const URL_CONSULTAR = "https://unstormable-trothless-gilberto.ngrok-free.dev/webhook-test/ec2331d9-fca8-482b-920e-aedce6dfc718"; // <-- Ponla aquí

  const bookingForm = document.getElementById('bookingForm');
  const dateInput = document.getElementById('date');
  const employeeSelect = document.getElementById('employee');
  const timeSelect = document.getElementById('time');

  // 1. FUNCIÓN PARA BLOQUEAR HORAS OCUPADAS
  async function actualizarDisponibilidad() {
    const fecha = dateInput.value;
    const barbero = employeeSelect.value;

    if (!fecha || !barbero || barbero === "Cualquiera") return;

    timeSelect.disabled = true;
    timeSelect.innerHTML = '<option>Consultando huecos...</option>';

    try {
      const response = await fetch(URL_CONSULTAR, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ fecha, barbero })
      });

      const data = await response.json();
      const ocupadas = data.horasOcupadas || [];

      // Horario de Max Studio: 11:00 a 21:00 cada 20 min
      const todasLasHoras = ["11:00", "11:20", "11:40", "12:00", "12:20", "12:40", "13:00", "13:20", "13:40", "14:00", "16:00", "16:20", "16:40", "17:00", "17:20", "17:40", "18:00", "18:20", "18:40", "19:00", "19:20", "19:40", "20:00", "20:20", "20:40"];

      timeSelect.innerHTML = '<option value="">Selecciona hora</option>';
      
      todasLasHoras.forEach(h => {
        const option = document.createElement('option');
        option.value = h;
        if (ocupadas.includes(h)) {
          option.disabled = true;
          option.text = h + " (Ocupado)";
          option.style.color = "#888";
        } else {
          option.text = h;
        }
        timeSelect.appendChild(option);
      });
      timeSelect.disabled = false;

    } catch (error) {
      console.error("Error disponibilidad:", error);
      timeSelect.innerHTML = '<option>Error al cargar disponibilidad</option>';
    }
  }

  // 2. ESCUCHAR CAMBIOS EN EL FORMULARIO
  dateInput.addEventListener('change', actualizarDisponibilidad);
  employeeSelect.addEventListener('change', actualizarDisponibilidad);

  // 3. FUNCIÓN PARA ENVIAR LA RESERVA FINAL
  bookingForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const datosCita = {
      nombre: document.getElementById('name').value,
      email: document.getElementById('email').value,
      barbero: employeeSelect.value,
      servicio: document.getElementById('service').options[document.getElementById('service').selectedIndex].text,
      fecha: dateInput.value,
      hora: timeSelect.value
    };

    try {
      const response = await fetch(URL_RESERVAR, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(datosCita)
      });

      if (response.ok) {
        alert("¡Reserva confirmada con éxito!");
        bookingForm.reset();
        timeSelect.disabled = true;
      } else {
        alert("Lo sentimos, no pudimos procesar tu reserva. Inténtalo de nuevo.");
      }
    } catch (error) {
      console.error("Error en reserva:", error);
      alert("Error de conexión con el servidor.");
    }
  });
</script>
    <!-- Header / Navigation -->
    <header id="header">
        <div class="container">
            <div class="logo">
                <h1>MAX STUDIO</h1>
            </div>
            <nav>
                <ul class="nav-links">
                    <li><a href="#home">Inicio</a></li>
                    <li><a href="#booking">Reservar</a></li>
                    <li><a href="#gallery">Galería</a></li>
                    <li><a href="#location">Ubicación</a></li>
                </ul>
                <div class="hamburger">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu">
        <span class="close-menu"><i class="fas fa-times"></i></span>
        <ul>
            <li><a href="#home">Inicio</a></li>
            <li><a href="#booking">Reservar</a></li>
            <li><a href="#gallery">Galería</a></li>
            <li><a href="#location">Ubicación</a></li>
        </ul>
    </div>

    <!-- Home Section -->
    <section id="home">
        <div class="hero-bg"></div>
        <div class="overlay"></div>
        <div class="hero-content">
            <h2>MAX STUDIO BARBER SHOP</h2>
            <p class="slogan">ESTILO, PRECISIÓN Y ACTITUD</p>
            <a href="#booking" class="btn-gold">Reservar Cita <i class="fas fa-arrow-right"></i></a>
        </div>
    </section>

    <!-- Booking Section -->
    <section id="booking">
        <div class="container">
            <h2 class="section-title">RESERVA TU CITA</h2>
            <div class="booking-wrapper">

                <!-- Booking Form -->
                <div class="booking-form-container">
                    <h3>Nueva Reserva</h3>
                    <form id="bookingForm">
                        <div class="form-group">
                            <label for="name">Nombre Completo</label>
                            <input type="text" id="name" name="name" required placeholder="Tu nombre">
                        </div>
                        <div class="form-group">
                            <label for="email">Correo Electrónico</label>
                            <input type="email" id="email" name="email" required placeholder="tu@email.com">
                        </div>
                        <div class="form-group">
                            <label for="employee">Selecciona Barbero</label>
                            <select id="employee" name="employee" required>
                                <option value="Cualquiera">Cualquiera</option>
                                <option value="Ayoub">Ayoub</option>
                                <option value="Ragnar Ab">Ragnar Ab</option>
                                <option value="Yasin">Yasin</option>
                                <option value="Alejandro">Alejandro</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="service">Servicio</label>
                            <select id="service" name="service" required>
                                <option value="" disabled selected>Elige un servicio</option>
                                <option value="11" data-duration="30">Corte de pelo - 11€ (30 min)</option>
                                <option value="16" data-duration="40">Cortar y barba - 16€ (40 min)</option>
                                <option value="6" data-duration="15">Corte de barba - 6€ (15 min)</option>
                                <option value="8" data-duration="20">Jubilados - 8€ (20 min)</option>
                                <option value="3" data-duration="10">Cejas - 3€ (10 min)</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <div class="form-group half">
                                <label for="date">Fecha</label>
                                <input type="date" id="date" name="date" required>
                            </div>
                            <div class="form-group half">
                                <label for="time">Hora</label>
                                <select id="time" name="time" required disabled>
                                    <option value="">Selecciona servicio y fecha primero</option>
                                </select>
                            </div>
                        </div>

                        <button type="submit" class="btn-gold full-width">CONFIRMAR RESERVA</button>
                    </form>
                    <div id="bookingMessage" class="message"></div>
                </div>

                <!-- Cancel Booking -->
                <div class="cancel-booking-container">
                    <h3>Cancelar Reserva</h3>
                    <form id="cancelForm">
                        <div class="form-group">
                            <label for="cancelEmail">Correo de la reserva</label>
                            <input type="email" id="cancelEmail" name="cancelEmail" required
                                placeholder="Email usado en la reserva">
                        </div>
                        <button type="submit" class="btn-outline">CANCELAR CITA</button>
                    </form>
                    <div id="cancelMessage" class="message"></div>
                </div>

            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section id="gallery">
        <div class="container">
            <h2 class="section-title">NUESTRO TRABAJO</h2>
            <div class="gallery-grid">
                <!-- Images from folder -->
                <!-- gallery content -->
                <div class="gallery-item"><img
                        src="assets/img/gallery/614854445_806688182423603_6381585991481972604_n.jpg" alt="Corte 1">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/614886055_911359418128691_6870970335472322327_n.jpg" alt="Corte 2">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/615047851_911313978132025_7686383220628662739_n.jpg" alt="Corte 3">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/615051952_1601498341006170_7528876136289270963_n.jpg" alt="Corte 4">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/617517021_1430504608639657_1068881685685668652_n.jpg" alt="Corte 5">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/618337475_1791124541579999_4100679849414398982_n.jpg" alt="Corte 6">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/619596011_4516614841895806_7695458174893846566_n.jpg" alt="Corte 7">
                </div>
                <div class="gallery-item"><img
                        src="assets/img/gallery/620013243_1321186406432520_1798237511895044667_n.jpg" alt="Corte 8">
                </div>
            </div>
        </div>
    </section>

    <!-- Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3 id="modalTitle">Título</h3>
            <p id="modalMessage">Mensaje aquí</p>
            <button class="btn-gold" id="closeModalBtn">Aceptar</button>
        </div>
    </div>

    <!-- Location Section -->
    <section id="location">
        <div class="container">
            <h2 class="section-title">UBICACIÓN</h2>
            <div class="location-content">
                <div class="map-container">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3038.567634629457!2d-3.6300000!3d40.3950000!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd4225c5d0e2e5cd%3A0x1234567890abcdef!2sBulevar%20de%20Indalecio%20Prieto%2C%2044%2C%2028032%20Madrid!5e0!3m2!1ses!2ses!4v1642680000000!5m2!1ses!2ses"
                        width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy">
                    </iframe>
                </div>
                <div class="address-box">
                    <i class="fas fa-map-marker-alt"></i>
                    <p>Bulevar de Indalecio Prieto, 44, Local 2,<br>28032, Madrid</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <h3>MAX STUDIO</h3>
                    <p>La mejor experiencia de barbería en Madrid.</p>
                </div>
                <div class="footer-col">
                    <h3>CONTACTO</h3>
                    <p><i class="fas fa-phone"></i> +34 123 456 789</p> <!-- Placeholder phone -->
                    <p><i class="fas fa-envelope"></i> info@maxstudio.com</p>
                </div>
                <div class="footer-col">
                    <h3>HORARIO</h3>
                    <p>Lunes - Sábado: 11:00 - 21:00</p>
                    <p>Domingo: Cerrado</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Max Studio Barber Shop. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="js/script.js"></script>
</body>

</html>
